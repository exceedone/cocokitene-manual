# パラメータ変数一覧
以下の項目で使用できる、パラメータ一覧です。

- 通知テンプレート
    - データ新規作成・更新など
    - 時間の経過
    - ボタン
    - ワークフロー
    - ユーザーの新規作成
    - ユーザーのパスワードリセット
    - 公開フォームの登録完了(ユーザー・管理者)通知、エラー通知
- ドキュメント出力
- カスタム列の自動採番
- メール送信の送信元表示名

## 変数一覧
### 日付
以下の例は、実行日時が「2018/02/17 11:20:32」の場合です。

| 項目 | 説明 |
| ---- | ---- |
| ${y} or ${year} | 実行時の年が、4桁で設定されます。(例：2018) |
| ${m} or ${month} | 実行時の月が設定されます。(例：8) |
| ${m:(整数)} or ${month:(整数)} | 実行時の月が、指定した整数の桁数で設定されます。(例：${m:2}と記入した場合、08) |
| ${d} or ${day} | 実行時の日が設定されます。(例：9) |
| ${d:(整数)} or ${day:(整数)} | 実行時の日が、指定した整数の桁数で設定されます。(例：${d:2}と記入した場合、09) |
| ${h} or ${hour} | 実行時の時間が設定されます。(例：7) |
| ${h:(整数)} or ${hour:(整数)} | 実行時の時間が、指定した整数の桁数で設定されます。(例：${hour:2}と記入した場合、07) |
| ${i} or ${minute} | 実行時の分が設定されます。(例：6) |
| ${i:(整数)} or ${minute:(整数)} | 実行時の分が、指定した整数の桁数で設定されます。(例：${minute:2}と記入した場合、06) |
| ${s} or ${second} | 実行時の秒が設定されます。(例：5) |
| ${s:(整数)} or ${second:(整数)} | 実行時の秒が、指定した整数の桁数で設定されます。(例：${second:2}と記入した場合、05) |
| ${ymdhms} or ${ymdhis} | yyyymmddhhiiss文字列(例：20180217112032) |
| ${ymdhm} or ${ymdhi} | yyyymmddhhii文字列(例：201802171120) |
| ${ymdh} | yyyymmddHH文字列(例：2018021711) |
| ${ymd} | yyyymmdd文字列(例：20180217) |
| ${ym} | yyyyMM文字列(例：201802) |
| ${hms} or ${his} | hhiiss文字列(例：112032) |
| ${hm} or ${hi} | hhii文字列(例：1120) |
| ${now} | 実行日時が、yyyymmddhhiiss形式で出力されます。(例：20180217112032) |
| ${now:(format)} | 実行日時が、指定したフォーマットの形式で出力されます。フォーマットは、<a href="https://www.php.net/manual/ja/function.date.php" target="_blank">こちら</a>をご参照ください。<br />(例：${now:y}と記入した場合、18) |

### システム値
| 項目 | 説明 |
| ---- | ---- |
| ${system:site_name} | システムのサイト名 |
| ${system:site_name_short} | システムのサイト名(短縮) |
| ${system:system_mail_from} | システムの送信元 |
| ${system:system_url} | システムのホームURL |
| ${system:login_url} | システムのログインURL |

### テーブル
| 項目 | 説明 |
| ---- | ---- |
| ${table_name} | 該当データのテーブル名(英数字)が設定されます。(v4.2.7より追加) |
| ${table_view_name} | 該当データのテーブル表示名が設定されます。(v4.2.7より追加) |

### データ
| 項目 | 説明 |
| ---- | ---- |
| ${id} | 登録されているデータのIDが設定されます。(例：123) |
| ${id:(整数)} | 登録されているデータのIDが、指定した整数の桁数で設定されます。(例：${id:5}と記入した場合、00123) |
| ${suuid} | 登録されているデータの、suuid(Short UUID. 20桁のランダム文字列)が設定されます。 |
| ${created_user} | データを登録したユーザー名が設定されます。(例：管理者) |
| ${updated_user} | データを更新したユーザー名が設定されます。(例：ユーザーA) |
| ${created_at} | データを登録した日時が設定されます。(例：2020/08/06 10:00:00) |
| ${updated_at} | データを更新した日時が設定されます。(例：2020/08/06 14:00:00) |
| ${value_url} | 登録されているデータを表示するリンクが設定されます。 |
| ${value:(列名)} | 登録されているデータの列の値が設定されます。<br />(例：ユーザーデータに対し、${value:user_code}と記入した場合、ユーザーコードが設定される) |

#### データ(オプション)
「${value:(列名)/(オプションキー1)=(オプション値1)}」のように記入することで、パラメータにオプションを追加することができます。複数ある場合はカンマ区切りしてください。  
例：
- ${value:mitsumori_date/format="Y"}
- ${value:mitsumori_price/disable_number_format=1,disable_currency_symbol=1}

| オプションキー | 説明 |
| ---- | ---- |
| ${value:(列名)/format="(日付フォーマット)"} | 列種類が「日付」「日時」のとき、登録されているデータの列の値をフォーマット変換して表示します。<br />(例1：「契約情報(contract)」テーブルに「契約日(contract_date)」列があり、契約年を表示したい場合、${value:contract_date/format="Y"}）<br />(例2：「契約情報(contract)」テーブルに「契約日(contract_date)」列があり、「yyyy/mm/dd」形式で表示したい場合、${value:contract_date/format="Y/m/d"}）|
| ${value:(列名)/disable_number_format=1} | 列種類が「整数」「小数」「通貨」のとき、数値カンマ文字列設定を無効にします。|
| ${value:(列名)/disable_currency_symbol=1} | 列種類が「通貨」のとき、通貨の表示形式設定(円マーク、$など)を無効にします。|


### リレーション、関連データ
| 項目 | 説明 |
| ---- | ---- |
| ${select_table:(列名).(参照先のテーブルの列名)} | 「列名」に該当する列が、「選択肢 (他のテーブルの値一覧から選択)」「ユーザー」「組織」の場合、参照先の列の値が設定されます。<br />   (例：「契約情報(contract)」テーブルに「顧客(client)」列があり、「顧客情報(client)」テーブルを参照している場合、${select_table:client.client_code}と設定すれば、「顧客情報(client)」テーブルの顧客コード(client_code)を表示できる) |
| ${parent:(参照先のテーブルの列名)} | 親テーブルの列の値が設定されます。<br />(例：「契約明細情報(contract_detail)」テーブルから、親である「契約情報(contract)」テーブルの契約コード(contract_code)を参照する場合、${parent:contract_code}と記入した場合、契約コードが設定される) |


### 個別
機能ごとに、個別の変数パラメータが設定されている場合があります。  
以下、各機能・画面と、その機能で使用できるパラメータの一覧です。  

#### 通知
メールやシステム内アラートで、ユーザーに通知を送信する場合に使用できます。

| 項目 | 説明 |
| ---- | ---- |
| ${user:user_name} | メール送付先ユーザーの、ユーザー名 |
| ${user:user_code} | メール送付先ユーザーの、ユーザーコード |
| ${user:email} | メール送付先ユーザーの、Eメールアドレス |

#### 通知(添付ファイル)
通知テンプレートの、列「カスタム添付ファイル」に、以下のルールでパラメータを設定することで、メール通知を実施時、そのカスタム列に登録されている添付ファイルを、ユーザーに送信します。  
詳細は[こちら](/ja/mail?id=添付ファイル・カスタム添付ファイル)をご確認ください。  
※現在、メール通知の場合のみ有効です。

| 項目 | 説明 |
| ---- | ---- |
| ${file:(カスタム列名)} | カスタム列の種類「ファイル」「画像」に登録されている添付ファイル |
| ${documents} | データ詳細画面に対して登録されている（下記の画像にあたる場所）添付ファイル |

#### ログインユーザー
ログイン時のみ使用できます。バッチ等で通知する場合は使用できません。

| 項目 | 説明 |
| ---- | ---- |
| ${login_user:user_name} | ログインユーザーの、ユーザー名 |
| ${login_user:user_code} | ログインユーザーの、ユーザーコード |
| ${login_user:email} | ログインユーザーの、Eメールアドレス |
| ${login_user:(列名)} | ログインユーザーの、指定した列の値が設定されます |

#### パスワードリセット
パスワードリセットのメール送付時のみ使用できます。

| 項目 | 説明 |
| ---- | ---- |
| ${system:password_reset_url} | システムのパスワードリセットURL |
| ${user:password} | メール送付先ユーザーの、ログインパスワード |

#### 公開フォーム
公開フォームの通知のみ使用できます。

| 項目 | 説明 |
| ---- | ---- |
| ${publicform:public_form_view_name} | 公開フォーム表示名 |
| ${publicform:inputs} | 公開フォーム ユーザー入力値 |

#### 公開フォーム(エラー発生時)
公開フォームのエラー発生時の通知のみ使用できます。

| 項目 | 説明 |
| ---- | ---- |
| ${error:message} | 公開フォーム エラー概要 |
| ${error:stacktrace} | 公開フォーム エラー詳細 |


#### プラグイン(ドキュメント出力)

| 項目 | 説明 |
| ---- | ---- |
| ${value_image:(列名)} | 「列名」に該当する列の種類が「画像」の場合、Excelに画像を出力します。 |
| ${value_image:(列名)/width=(サイズ整数),height=(サイズ整数)} | 出力する画像の幅を指定する場合、オプションを入力してください。widthもしくはheightどちらかの指定も可能です。 |


## 例
※実行日が2018/8/9、対象データのIDが100、対象データのuser_code(ユーザーコード)が"U12345"の場合
- U-${id:4} → U-0100
- ${y}-${m}-${d}-${id} → 2018-08-09-100
- ${y}${m}${d}-${id:5} → 20180809-00100
- ${now:y}${m}${d}-${id:4} → 180809-0100
- ${y}${m}${d}-${value:user_code} → 20180809-U12345
